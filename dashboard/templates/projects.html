<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <title>repustate</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/static/assets/css/feather.css" />
    <link rel="stylesheet" href="/static/assets/css/bootstrap-datepicker.min.css" />
    <link rel="stylesheet" href="/static/assets/css/tagify.css" />

    <link rel="stylesheet" href="/static/assets/css/style.css" />
    <link rel="stylesheet" href="/static/assets/css/apexcharts.css" />

    <script>
        window.Promise ||
            document.write(
                '<script src="https://cdn.jsdelivr.net/npm/promise-polyfill@8/dist/polyfill.min.js"><\/script>'
            );
        window.Promise ||
            document.write(
                '<script src="https://cdn.jsdelivr.net/npm/eligrey-classlist-js-polyfill@1.2.20171210/classList.min.js"><\/script>'
            );
        window.Promise ||
            document.write(
                '<script src="https://cdn.jsdelivr.net/npm/findindex_polyfill_mdn"><\/script>'
            );
    </script>

    <script>
        // Replace Math.random() with a pseudo-random number generator to get reproducible results in e2e tests
        // Based on https://gist.github.com/blixt/f17b47c62508be59987b
        var _seed = 42;
        Math.random = function () {
            _seed = (_seed * 16807) % 2147483647;
            return (_seed - 1) / 2147483646;
        };
    </script>

    <script>
        var projects_data = {{ projects_data | safe }};
    </script>
</head>

<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-main navbar-light">
            <a class="navbar-brand" href="#">
                <img src="/static/assets/images/logo-repustate-dark.svg" />
            </a>
            <div class="d-none visible-md align-items-center">
                <h3 class="">Dashbord</h3>
                <div class="header-right-sidebar d-flex align-items-center mr-3">
                    <div class="dropdown avatar-dropdown">
                        <a class="menu-avatar d-flex align-items-center dropdown-toggle" href="#" id="navbarDropdown"
                            role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <img src="/static/assets/images/Avatar.svg" alt="" />
                            <span>
                                Terry Williams
                                <small>Manager</small>
                            </span>
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="#"><i class="fe fe-user"></i> My Account</a>
                            <a class="dropdown-item" href="#"><i class="fe fe-settings"></i> Edit Profile</a>
                            <a class="dropdown-item" href="/logout/"><i class="fe fe-log-out"></i> Logout</a>
                        </div>
                    </div>
                    <a href="#" id="lightdark1">
                        <i class="fe fe-moon"></i>
                        <i class="fe fe-sun"></i>
                    </a>
                </div>
            </div>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <i class="fe fe-menu"></i>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <h3 class="d-none d-lg-flex">Dashbord</h3>

                <ul class="navbar-nav ml-auto">
                    <li class="nav-item active">
                        <a class="nav-link" href="#">
                            <i class="fe fe-upload"></i> Upload Data</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            <i class="fe fe-hash"></i> Manage Aspect</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            <i class="fe fe-crosshair"></i> Manage Sentiment</a>
                    </li>
                </ul>
                <div class="header-right-sidebar d-none d-lg-flex align-items-center">
                    <div class="dropdown avatar-dropdown">
                        <a class="menu-avatar d-flex align-items-center dropdown-toggle" href="#" id="navbarDropdown"
                            role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <img src="/static/assets/images/Avatar.svg" alt="" />
                            <span>
                                Terry Williams
                                <small>Manager</small>
                            </span>
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="#"><i class="fe fe-user"></i> My Account</a>
                            <a class="dropdown-item" href="#"><i class="fe fe-settings"></i> Edit Profile</a>
                            <a class="dropdown-item" href="#"><i class="fe fe-log-out"></i> Logout</a>
                        </div>
                    </div>
                    <a href="#" id="lightdark">
                        <i class="fe fe-moon"></i>
                        <i class="fe fe-sun"></i>
                    </a>
                </div>
            </div>
        </nav>
    </header>

    <div class="sidebar">
        <a href="#" id="sidemenu">
            <i class="fe fe-menu"></i>
        </a>
        <h3>Projects</h3>
        <ul>
            {% for project in projects_data %}
            <li>
                <a href="/projects/{{project.id}}/"> {{project.name}} </a>
            </li>
            {% endfor %}
        </ul>
    </div>

    <div class="main-content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <div class="dashboard-title d-flex flex-wrap">
                        Active projects <span>{{projects_count}}</span>
                    </div>
                </div>
            </div>
            <div class="row" id="project-cards"></div>
        </div>
    </div>

    <!-- js -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="/static/assets/js/bootstrap-datepicker.min.js"></script>
    <script src="/static/assets/js/jQuery.tagify.min.js"></script>

    <script>
        // if IE, add IE tagify's polyfills
        !(function (d) {
            if (!d.currentScript) {
                var s = d.createElement("script");
                s.src = "/static/assets/js/tagify.polyfills.min.js";
                d.head.appendChild(s);
            }
        })(document);
    </script>

    <script data-name="basic">
        (function () {
            // The DOM element you wish to replace with Tagify
            var input = document.querySelector("input[name=basic]");

            // initialize Tagify on the above input node reference
            new Tagify(input);
        })();
    </script>

    <script data-name="basic1">
        (function () {
            // The DOM element you wish to replace with Tagify
            var input = document.querySelector("input[name=basic1]");

            // initialize Tagify on the above input node reference
            new Tagify(input);
        })();
    </script>

    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip();
        });
    </script>
    <script>
        $("#sandbox-container input").datepicker({
            todayHighlight: true,
        });
    </script>
    <script>
        $("#lightdark").click(function () {
            $("body").toggleClass("dark-theme");
        });
    </script>
    <script>
        $("#lightdark1").click(function () {
            $("body").toggleClass("dark-theme");
        });
    </script>
    <script>
        $("#sidemenu").click(function () {
            $("body").toggleClass("menu-close");
        });
    </script>

    <script>
        (function () {
            let projectCards = document.getElementById("project-cards");
            for (project of projects_data) {
                let positiveChartID = `positive-chart-${project.id}`;
                let negativeChartID = `negative-chart-${project.id}`;
                let neutralChartID = `neutral-chart-${project.id}`;
                let total_data =
                    project.positive_count +
                    project.neutral_count +
                    project.negative_count;
                let positivePercentage = (
                    (project.positive_count / total_data) *
                    100
                ).toFixed(2);
                let negativePercentage = (
                    (project.negative_count / total_data) *
                    100
                ).toFixed(2);
                let neutralPercentage = (
                    (project.neutral_count / total_data) *
                    100
                ).toFixed(2);
                let div = document.createElement("div");
                div.className = "col-12 col-md-6 col-lg-4 project-card";
                let project_card = `
            <div class="project-card-inner">
                <div class="project-header">
                    <a href="/projects/${project.id}/" style="text-decoration:none;color:#1E2746;">${project.name}</a>
                    <div class="dropdown more-dropdown">
                        <a class="dropdown-toggle" href="#" id="projectdropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fe fe-more-horizontal"></i>
                            
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="projectdropdown">
                            <a class="dropdown-item" href="#"><i class="fe fe-edit-2"></i> Edit Project</a>
                            <a class="dropdown-item" href="#"><i class="fe fe-share-2"></i> Share Project</a>           
                            <a class="dropdown-item" href="#"><i class="fe fe-trash-2"></i> Delete</a>
                        </div>
                    </div>
                </div>
                <div class="project-list-alldata">
                    ${total_data}
                    <span>Total data items</span>
                </div>
                <div class="project-list-data">
                    <table class="table mb-0">
                    
                        <tbody>
                            <tr class="postive-data">
                            <td >
                                <small>Total Positive</small>
                            </td>
                            <td>
                                <span>${project.positive_count}</span>
                            </td>
                            <td class="text-right">${positivePercentage}%</td>
                            <td class="text-right small-chart">
                                <div id="${positiveChartID}"></div>
                            </td>
                            </tr>
                            <tr class="negative-data">
                            
                            <td>
                                <small>Total Negative</small>
                            </td>
                            <td>
                                <span>${project.negative_count}</span>
                            </td>
                            <td class="text-right">${negativePercentage}%</td>
                            <td class="text-right small-chart">
                                <div id="${negativeChartID}"></div>
                            </td>
                            </tr>
                            <tr class="neutral-data">
                            
                            <td>
                                <small>Total Neutral</small>
                            </td>
                            <td>
                                <span>${project.neutral_count}</span>
                            </td>
                            <td class="text-right">${neutralPercentage}%</td>
                            <td class="text-right small-chart">
                                <div id="${neutralChartID}"></div>
                            </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            `;

                div.innerHTML = project_card;
                projectCards.appendChild(div);
                let positiveChartOptions = {
                    series: [positivePercentage],
                    chart: {
                        type: "radialBar",
                        width: 30,
                        height: 30,
                        sparkline: {
                            enabled: true,
                        },
                    },

                    colors: ["#28C76F"],
                    dataLabels: {
                        enabled: false,
                    },
                    plotOptions: {
                        radialBar: {
                            hollow: {
                                margin: 0,
                                size: '40%',
                            },
                            track: {
                                margin: 0,
                            },
                            dataLabels: {
                                show: false,
                            },
                        },
                    },
                };


                let positiveChart = new ApexCharts(
                    document.querySelector(`#${positiveChartID}`),
                    positiveChartOptions
                );
                positiveChart.render();

                var negativeChartOptions = {
                    series: [negativePercentage],
                    chart: {
                        type: "radialBar",
                        width: 30,
                        height: 30,
                        sparkline: {
                            enabled: true,
                        },
                    },

                    colors: ["#EA5455"],
                    dataLabels: {
                        enabled: false,
                    },
                    plotOptions: {
                        radialBar: {
                            hollow: {
                                margin: 0,
                                size: '40%',
                            },
                            track: {
                                margin: 0,
                            },
                            dataLabels: {
                                show: false,
                            },
                        },
                    },
                };

                let negativeChart = new ApexCharts(
                    document.querySelector(`#${negativeChartID}`),
                    negativeChartOptions
                );
                negativeChart.render();
                let neutralChartOptions = {
                    series: [neutralPercentage],
                    chart: {
                        type: "radialBar",
                        width: 30,
                        height: 30,
                        sparkline: {
                            enabled: true,
                        },
                    },

                    colors: ["#00CFE8"],
                    dataLabels: {
                        enabled: false,
                    },
                    plotOptions: {
                        radialBar: {
                            hollow: {
                                margin: 0,
                                size: '40%',
                            },
                            track: {
                                margin: 0,
                            },
                            dataLabels: {
                                show: false,
                            },
                        },
                    },
                };

                let neutralChart = new ApexCharts(document.querySelector(`#${neutralChartID}`), neutralChartOptions);
                neutralChart.render();
            }
        })();
    </script>
</body>

</html>